%imapct_data_graphics
clear all; close all; clc

load('Impact_data.mat')

n = 30;
% Generar gifs
%{
Velocidad2 = abs(real(Velocidad2));
f_name = 'Velociadad_2.gif';
for i = 1:n
   
   scatter(Coordenadas_x(:,i),Coordenadas_y(:,i),10,Velocidad2(:,i),'filled'); 
   colorbar()
   caxis([0 1e3]);
   title(f_name)
   drawnow
   
   frame = getframe(1);
   im = frame2im(frame);
   [imind,cm] = rgb2ind(im,256);
   
   if i == 1
       imwrite(imind,cm,f_name,'gif', 'Loopcount',inf);
   else
       imwrite(imind,cm,f_name,'gif','WriteMode','append');
   end
   
end
%}

% Subplots
Velocidad2 = abs(real(Velocidad2));
c = 1;
figure(1)
for i = n-6:n-1
    %if mod(i-1,5) == 0
   subplot(3,3,c); c=c+1;
   scatter(Coordenadas_x(:,i),Coordenadas_y(:,i),5,Velocidad2(:,i),'filled'); 
   caxis([0 1e3]);
   xlim([-4e-3,0.5e-3])
        ylim([-3e-3,3e-3])
   axis('equal')
   axis off
   if c==3
       title('Velocidad_2')
   end
   subplot(3,3,7:9)
   
end